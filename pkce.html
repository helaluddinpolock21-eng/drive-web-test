<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PKCE Generator</title>
</head>
<body>
  <h2>PKCE Generator</h2>
  <button onclick="generate()">Generate PKCE</button>
  <pre id="out"></pre>

  <script>
    function base64urlencode(str) {
      return btoa(String.fromCharCode.apply(null, new Uint8Array(str)))
        .replace(/\+/g, "-").replace(/\//g, "_").replace(/=+$/, "");
    }

    async function generate() {
      const array = new Uint8Array(32);
      crypto.getRandomValues(array);
      const code_verifier = base64urlencode(array);

      const encoder = new TextEncoder();
      const data = encoder.encode(code_verifier);
      const digest = await crypto.subtle.digest("SHA-256", data);
      const code_challenge = base64urlencode(digest);

      document.getElementById("out").innerText =
        "code_verifier:\n" + code_verifier +
        "\n\ncode_challenge:\n" + code_challenge;
    }
  </script>
</body>
</html>
